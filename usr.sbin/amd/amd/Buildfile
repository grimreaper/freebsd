# Makefile for amd
# 	This file is under a "BSD" copyright (c) by David O'Brien 1998
#
# $FreeBSD$

.PATH: ${BSDSRCTOP}/contrib/amd/amd

PROG = amd

SRCS = \
	am_ops.c \
	amd.c \
	amfs_auto.c \
	amfs_direct.c \
	amfs_error.c \
	amfs_generic.c \
	amfs_host.c \
	amfs_link.c \
	amfs_linkx.c \
	amfs_nfsl.c \
	amfs_nfsx.c \
	amfs_program.c \
	amfs_root.c \
	amfs_toplvl.c \
	amfs_union.c \
	amq_subr.c \
	amq_svc.c \
	autil.c \
	clock.c \
	conf.c \
	conf_parse.y \
	conf_tok.l \
	get_args.c \
	info_exec.c \
	info_file.c \
	info_hesiod.c \
	info_ndbm.c \
	info_nis.c \
	info_passwd.c \
	info_union.c \
	map.c \
	mapc.c \
	mntfs.c \
	mount_xdr.c \
	nfs_prot_svc.c \
	nfs_start.c \
	nfs_subr.c \
	ops_cdfs.c \
	ops_mfs.c \
	ops_nfs.c \
	ops_nfs3.c \
	ops_nullfs.c \
	ops_pcfs.c \
	ops_tfs.c \
	ops_ufs.c \
	ops_umapfs.c \
	ops_unionfs.c \
	opts.c \
	readdir.c \
	restart.c \
	rpc_fwd.c \
	sched.c \
	srvr_amfs_auto.c \
	srvr_nfs.c

CFLAGS += -I${BSDSRCTOP}/contrib/amd/amd
CFLAGS += -I${COMMONSTAGEDIR}/usr/include/rpcsvc
CFLAGS += -I${COMMONSHAREDSTAGEDIR}/usr/include/rpcsvc
CFLAGS += -DHAVE_MAP_HESIOD

LDADD += -lamu -lwrap

mount_xdr.c: ${MOUNT_X}
	${RPCGEN} -C -c -DWANT_NFS3 ${MOUNT_X} -o ${.TARGET}

.include <bsd.prog.mk>
